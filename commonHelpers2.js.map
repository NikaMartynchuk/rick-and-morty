{"version":3,"file":"commonHelpers2.js","sources":["../src/js/episode-script.js"],"sourcesContent":["import { getEpisodes, getEpisodeById, getCharacterById } from \"./API.js\";\n\nconst episodesContainer = document.getElementById(\"episodes\");\nconst loadMoreBtn = document.getElementById(\"loadMore\");\nconst nameInput = document.getElementById(\"name\");\nconst seasonSelect = document.getElementById(\"season\");\n\nconst popup = document.getElementById(\"popup\");\nconst popupContent = document.getElementById(\"popupContent\");\nconst closePopup = document.getElementById(\"closePopup\");\n\nconst noResults = document.getElementById(\"noResults\");\n\nlet currentPage = 1;\nlet allPages = 1;\nlet filters = {};\n\nfunction debounce(fn, delay = 300) {\n  let t;\n  return (...args) => {\n    clearTimeout(t);\n    t = setTimeout(() => fn(...args), delay);\n  };\n}\n\nfunction createEpisodeCard(ep) {\n  const div = document.createElement(\"div\");\n  div.className = \"episode-card\";\n  div.innerHTML = `\n    <div class=\"episode-bg\">\n      <div class=\"overlay\"></div>\n      <div class=\"episode-info\">\n        <h3>${ep.name}</h3>\n        <p>${new Date(ep.air_date).toDateString()}</p>\n      </div>\n    </div>\n  `;\n  div.addEventListener(\"click\", () => openPopup(ep.id));\n  episodesContainer.appendChild(div);\n}\n\nasync function loadEpisodes() {\n  loadMoreBtn.style.display = \"none\";\n\n  try {\n    const data = await getEpisodes(currentPage, filters);\n\n    if (currentPage === 1) episodesContainer.innerHTML = \"\";\n\n    if (!data || !data.results?.length) {\n      noResults.classList.remove(\"hidden\");\n      episodesContainer.classList.add(\"hidden\");\n      return;\n    }\n\n    noResults.classList.add(\"hidden\");\n    episodesContainer.classList.remove(\"hidden\");\n\n    allPages = data.info.pages;\n    data.results.forEach(createEpisodeCard);\n\n    if (currentPage < allPages) loadMoreBtn.style.display = \"block\";\n\n  } catch (err) {\n    console.error(\"Error loading episodes:\", err);\n  }\n}\n\n/* ✅ Open Modal */\nasync function openPopup(id) {\n  popup.classList.remove(\"hidden\");\n  popup.classList.add(\"visible\");\n\n  popupContent.innerHTML = \"<p>Loading...</p>\";\n\n  try {\n    const ep = await getEpisodeById(id);\n    const chars = await Promise.all(\n      ep.characters.slice(0, 4).map(async (c) => {\n        return await getCharacterById(c.split(\"/\").pop());\n      })\n    );\n\n    popupContent.innerHTML = `\n      <div class=\"popup-box-border\">\n        <h2>${ep.name}</h2>\n        <p class=\"date\">${new Date(ep.air_date).toDateString()}</p>\n\n        <h3 class=\"sub-title\">Major Characters</h3>\n<div class=\"popup-characters-list\">\n          ${chars\n            .map(\n              (ch) => `\n              <div class=\"character-row\">\n                <img src=\"${ch.image}\" alt=\"${ch.name}\">\n                <p>${ch.name}</p>\n              </div>\n            `\n            )\n            .join(\"\")}\n        </div>\n      </div>\n    `;\n  } catch (err) {\n    popupContent.innerHTML = \"<p>Error loading episode.</p>\";\n  }\n}\n\n/* ✅ Close Modal */\nfunction closePopupWindow() {\n  popup.classList.remove(\"visible\");\n  popup.classList.add(\"hidden\");\n}\n\nclosePopup.addEventListener(\"click\", closePopupWindow);\n\npopup.addEventListener(\"click\", (e) => {\n  if (e.target === popup) closePopupWindow();\n});\n\n/* Load More */\nloadMoreBtn.addEventListener(\"click\", () => {\n  currentPage++;\n  loadEpisodes();\n});\n\n/* Search */\nnameInput.addEventListener(\n  \"input\",\n  debounce(() => {\n    filters.name = nameInput.value.trim();\n    if (!filters.name) delete filters.name;\n    currentPage = 1;\n    loadEpisodes();\n  }, 350)\n);\n\n/* Season Filter */\nseasonSelect.addEventListener(\"change\", () => {\n  const v = seasonSelect.value;\n  if (v) filters.episode = v;\n  else delete filters.episode;\n\n  currentPage = 1;\n  loadEpisodes();\n});\n\n/* ✅ Load first episodes */\nloadEpisodes();\n"],"names":["episodesContainer","loadMoreBtn","nameInput","seasonSelect","popup","popupContent","closePopup","noResults","currentPage","allPages","filters","debounce","fn","delay","t","args","createEpisodeCard","ep","div","openPopup","loadEpisodes","data","getEpisodes","_a","err","id","getEpisodeById","chars","c","getCharacterById","ch","closePopupWindow","e","v"],"mappings":"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"}