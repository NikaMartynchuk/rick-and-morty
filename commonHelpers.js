import{g as C}from"./assets/animated-element-0284cb7f.js";import"./assets/vendor-6837a909.js";const d=document.getElementById("character-list"),i=document.querySelector(".load-more"),x=document.querySelector(".character-input"),T=document.querySelectorAll(".character-filtration select");let m=1,y=!1,f={};function O(e,n=!1){if(n&&(d.innerHTML=""),!e||e.length===0){d.innerHTML="<li>No characters found.</li>",i.style.display="none";return}const r=e.map(t=>`
    <li>
      <img class="character__img-list" src="${t.image}" alt="${t.name}">
      <h2 class="character__name">${t.name}</h2>
      <h3 class="character__info character__origin">
        <span class="character__span">Origin:</span> ${t.origin.name}
      </h3>
      <h3 class="character__info character__location">
        <span class="character__span">Location:</span> ${t.location.name}
      </h3>
    </li>
  `).join("");d.innerHTML+=r}async function E(e=1,n={},r=!1){var t;if(!y){y=!0,i.disabled=!0;try{const o=await C(e,n);O(o.results,r),i.style.display=(t=o.info)!=null&&t.next?"block":"none"}catch(o){console.error("Error loading characters:",o),d.innerHTML="<li>No characters found.</li>",i.style.display="none"}finally{y=!1,i.disabled=!1}}}function N(){const e={name:x.value.trim(),status:"",species:"",type:"",gender:""};return T.forEach(n=>{const r=n.previousElementSibling.textContent.toLowerCase().trim(),t=n.value.trim();r.includes("status")&&(e.status=t),r.includes("species")&&(e.species=t),r.includes("type")&&(e.type=t),r.includes("gender")&&(e.gender=t)}),e}function k(){m=1,f=N(),console.log("Фільтри:",f),E(m,f,!0)}E(m);i.addEventListener("click",()=>{m++,E(m,f)});x.addEventListener("input",k);T.forEach(e=>e.addEventListener("change",k));const u=document.getElementById("characterModal"),j=document.getElementById("charCloseModal"),B=document.getElementById("charImage"),P=document.getElementById("charStatus"),A=document.getElementById("charSpecies"),F=document.getElementById("charGender"),G=document.getElementById("charOrigin"),R=document.getElementById("charLocation"),V=document.getElementById("charType"),L=document.getElementById("episodesList");async function z(e){var n,r;try{if(typeof e=="number"||typeof e=="string"){const t=await C(1,{id:e});if(e=t.results?t.results[0]:null,!e){console.error("Character not found by id");return}}B.src=e.image,B.alt=e.name||"Character",P.textContent=e.status||"Unknown",A.textContent=e.species||"Unknown",F.textContent=e.gender||"Unknown",G.textContent=((n=e.origin)==null?void 0:n.name)||"Unknown",R.textContent=((r=e.location)==null?void 0:r.name)||"Unknown",V.textContent=e.type||"Unknown",L.innerHTML="<li>Loading episodes...</li>";try{const t=(e.episode||[]).slice(0,5).map(s=>fetch(s).then(g=>g.json())),o=await Promise.all(t);L.innerHTML=o.length?o.map(s=>`<li><strong>${s.name}</strong><br>Episode: ${s.episode} | Air date: ${s.air_date}</li>`).join(""):"<li>No episodes</li>"}catch(t){L.innerHTML="<li>Episodes unavailable</li>",console.error("Error loading episodes:",t)}u.classList.remove("hidden")}catch(t){console.error("Error in openCharacterModal:",t)}}j.addEventListener("click",()=>u.classList.add("hidden"));u.addEventListener("click",e=>{e.target===u&&u.classList.add("hidden")});d.addEventListener("click",e=>{var g;const n=e.target.closest("li");if(!n)return;const r=n.querySelector(".character__name"),t=n.querySelector("img"),o=(g=r==null?void 0:r.textContent)==null?void 0:g.trim(),s=t==null?void 0:t.src;o&&C(1,{name:o}).then(a=>{var _,w,M,I;if(!a||!a.results||a.results.length===0){console.warn("No results from getCharacters for name:",o);return}let h=null;if(s&&(h=a.results.find(c=>{if(!c.image)return!1;if(c.image===s)return!0;try{const l=new URL(c.image).pathname.split("/").pop(),p=new URL(s).pathname.split("/").pop();return l===p}catch{return!1}})),!h&&a.results.length>1){const c=(w=(_=n.querySelector(".character__origin"))==null?void 0:_.textContent)==null?void 0:w.replace("Origin:","").trim(),l=(I=(M=n.querySelector(".character__location"))==null?void 0:M.textContent)==null?void 0:I.replace("Location:","").trim();h=a.results.find(p=>{var S,v;const H=((S=p.origin)==null?void 0:S.name)||"",U=((v=p.location)==null?void 0:v.name)||"",$=c?H.toLowerCase().includes(c.toLowerCase()):!0,q=l?U.toLowerCase().includes(l.toLowerCase()):!0;return $&&q})}const b=h||a.results[0];z(b)}).catch(a=>{console.error("Error fetching character via getCharacters:",a)})});
//# sourceMappingURL=commonHelpers.js.map
